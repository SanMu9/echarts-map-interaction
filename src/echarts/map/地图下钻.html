<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>地图下钻</title>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 100%;
            height: 100%;
            background-color: #181818;
            /* border-color:  */
        }
    </style>
</head>

<body>
    <div class="container" id="container"></div>
    <script src="../../../public/js/jquery.min.js"></script>
    <script src="../../../public/js/echarts-4.1.0.js"></script>
    <script>
        var dom = document.querySelector("#container"),
            mychart = echarts.init(dom),
            // mapLevel = 1,
            option = {
                graphic: {
                    elements: [{
                        type: "group",
                        id: "china",
                        width: 60,
                        height: 40,
                        left: 20,
                        top: 20,
                        // $action:"replace",
                        // info:"china",
                        onclick: function (param) {
                            // console.log(param)
                            // console.log(this)
                            let mapName = param.target.info;
                            if (mapName == "china") {
                                option.series[0].map = mapName;
                                option.geo[0].map = mapName;
                                option.graphic.elements[1].ignore=true;
                                option.graphic.elements[2].ignore=true;
                                console.log('SSS')
                                // console.log(option.graphic.elements,"sss")
                                mychart.setOption(option);
                                // mychart.resize()
                            }
                        },
                        children: [{
                            type: "line",
                            shape: {
                                x1: 0,
                                y1: 0,
                                x2: 60,
                                y2: 0
                            },
                            slient: true,
                            // info:"china",
                            style: {
                                fill: "#FFFFFF",
                                stroke: "#FFFFFF",
                                lineWidth: 2
                            }
                        }, {
                            type: "text",
                            left: "center",
                            top: "middle",
                            // id:"china",
                            info: "china",
                            style: {
                                // x: 0,
                                // y: 0,
                                font: '18px "Microsoft YaHei", sans-serif',
                                text: "中国",
                                fill: "#FFFFFF",
                                stroke: "#FFFFFF"
                            }
                        }, {
                            type: "line",
                            slient: true,
                            shape: {
                                x1: 0,
                                y1: 40,
                                x2: 60,
                                y2: 40,
                            },
                            style: {
                                fill: "#FFFFFF",
                                stroke: "#FFFFFF",
                                lineWidth: 2
                            }
                        }]
                    }]
                },
                geo: [{
                    map: "china",
                }],
                series: [{
                    type: "map",
                    map: "china",
                    selectedMode: "single"
                }]
            };
        var arrow = {
            type: "group",
            left: 80,
            top: 20,
            width: 20,
            height: 40,
            ignore:true,
            // $action:"replace",
            children: [{
                type: "line",
                shape: {
                    x1: 0,
                    y1: 0,
                    x2: 20,
                    y2: 0
                },
                slient: true,
                // info:"china",
                style: {
                    fill: "#FFFFFF",
                    stroke: "#FFFFFF",
                    lineWidth: 2
                }
            }, {
                type: "polyline",

                shape: {
                    points: [
                        [10, 10],
                        [15, 20],
                        [10, 30]
                    ]
                },
                style: {
                    // fill:"#FFFFFF",
                    stroke: "#FFFFFF",
                    lineWidth: 2
                }
            }, {
                type: "line",
                shape: {
                    x1: 0,
                    y1: 40,
                    x2: 20,
                    y2: 40
                },
                slient: true,
                // info:"china",
                style: {
                    fill: "#FFFFFF",
                    stroke: "#FFFFFF",
                    lineWidth: 2
                }
            }]
        };
        var graphic = {
            type: "group",
            id: "level2",
            width: 60,
            height: 40,
            left: 100,
            top: 20,
            ignore:true,
            // $action:"replace",
            // info:"china",
            // onclick: function (param) {
            //     // console.log(param)
            //     // console.log(this)
            //     let mapName = param.target.info;
            //     if (mapName == "china") {
            //         option.series[0].map = mapName;
            //         option.geo[0].map = mapName;
            //         mychart.setOption(option);
            //     }
            // },
            children: [{
                type: "line",
                shape: {
                    x1: 0,
                    y1: 0,
                    x2: 60,
                    y2: 0
                },
                slient: true,
                // info:"china",
                style: {
                    fill: "#FFFFFF",
                    stroke: "#FFFFFF",
                    lineWidth: 2
                }
            }, {
                type: "text",
                left: "center",
                top: "middle",
                // id:"china",
                info: undefined,
                style: {
                    // x: 0,
                    // y: 0,
                    font: '18px "Microsoft YaHei", sans-serif',
                    text: "",
                    fill: "#FFFFFF",
                    stroke: "#FFFFFF"
                }
            }, {
                type: "line",
                slient: true,
                shape: {
                    x1: 0,
                    y1: 40,
                    x2: 60,
                    y2: 40,
                },
                style: {
                    fill: "#FFFFFF",
                    stroke: "#FFFFFF",
                    lineWidth: 2
                }
            }]
        };

        var china = "../../../public/json/china.json",
            xinjiang = "../../../public/json/新疆维吾尔自治区.json",
            shanghai = "../../../public/json/上海市.json",
            neimengu = "../../../public/json/内蒙古自治区.json",
            anhui = "../../../public/json/安徽省.json",
            shandong = "../../../public/json/山东省.json",
            guangdong = "../../../public/json/广东省.json",
            jiangsu = "../../../public/json/江苏省.json",
            henan = "../../../public/json/河南省.json",
            hainan = "../../../public/json/海南省.json",
            hubei = "../../../public/json/湖北省.json",
            hunan = "../../../public/json/湖南省.json",
            fujian = "../../../public/json/福建省.json",
            xizang = "../../../public/json/西藏自治区.json",
            guizhou = "../../../public/json/贵州省.json",
            liaoning = "../../../public/json/辽宁省.json",
            shanxi = "../../../public/json/陕西省.json",
            qinghai = "../../../public/json/青海省.json",
            heilongjiang = "../../../public/json/黑龙江省.json",
            yunnan = "../../../public/json/云南省.json",
            beijing = "../../../public/json/北京市.json",
            jilin = "../../../public/json/吉林省.json",
            sichuan = "../../../public/json/四川省.json",
            tianjin = "../../../public/json/天津市.json",
            ningxia = "../../../public/json/宁夏回族自治区.json",
            guangxi = "../../../public/json/广西壮族自治区.json",
            jiangxi = "../../../public/json/江西省.json",
            hebei = "../../../public/json/河北省.json",
            zhejiang = "../../../public/json/浙江省.json",
            hainan = "../../../public/json/海南省.json",
            aomeng = "../../../public/json/澳门特别行政区.json",
            gansu = "../../../public/json/甘肃省.json",
            fujian = "../../../public/json/福建省.json",
            shanxi2 = "../../../public/json/山西省.json",
            chongqing = "../../../public/json/重庆市.json",
            hangkong = "../../../public/json/香港特别行政区.json";

        var cityMap = {
            "china": china,
            "新疆": xinjiang,
            "上海": shanghai,
            "内蒙古": neimengu,
            "安徽": anhui,
            "山东": shandong,
            "广东": guangdong,
            "江苏": jiangsu,
            "海南": hainan,
            "河南": henan,
            "湖北": hubei,
            "湖南": hunan,
            "福建": fujian,
            "西藏": xizang,
            "贵州": guizhou,
            "辽宁": liaoning,
            "陕西": shanxi,
            "青海": qinghai,
            "黑龙江": heilongjiang,
            "云南": yunnan,
            "北京": beijing,
            "吉林": jilin,
            "四川": sichuan,
            "天津": tianjin,
            "宁夏": ningxia,
            "广西": guangxi,
            "江西": jiangxi,
            "河北": hebei,
            "浙江": zhejiang,
            "海南": hainan,
            "澳门": aomeng,
            "甘肃": gansu,
            "福建": fujian,
            "山西": shanxi2,
            "香港": hangkong,
            "重庆": chongqing
        };
        $.getJSON(china, function (data) {
            option.graphic.elements.push(arrow);
            option.graphic.elements.push(graphic)
            echarts.registerMap("china", data);
            mychart.setOption(option);
            console.log("1")

        })
        mychart.on("mapselectchanged", function (params) {
            // console.log("2")
            showClicked(params.batch[0].name)
        });

        function showClicked(name) {

            // var urlName = ;
            // graphic.children[1].info = name;
            

            // console.log(urlName)
            $.getJSON(cityMap[name], function (data) {
                option.graphic.elements[2].children[1].style.text = name;
                option.graphic.elements[1].ignore = false;
                option.graphic.elements[2].ignore = false;

                option.geo[0].map = name;
                console.log("3");
                option.series[0].map = name;
                // mychart.clear();
                echarts.registerMap(name, data);
                // setTimeout(function () {
                // }, 500)
                mychart.setOption(option);
                // mychart.resize();
            })
        }
    </script>
</body>

</html>